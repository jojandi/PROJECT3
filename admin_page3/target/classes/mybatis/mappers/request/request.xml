<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="project3.gamja.admin.dao.RequestDAO">

	<!-- 도서발주 페이지 select -->
	<select id="selectre" resultType="requestDTO" parameterType="requestDTO">
		select * from (
			SELECT 
			    rownum as rnum, o.os_id, k.book_name, k.book_author, k.book_pub, l.lib_name, o.os_date, e.emp_name
			FROM 
			    library l 
			LEFT OUTER JOIN user_loan u ON l.lib_id = u.lib_id
			LEFT OUTER JOIN tbl_user t ON u.loan_seq = t.loan_seq
			LEFT OUTER JOIN bookflix_user f ON t.user_seq = f.user_seq
			LEFT OUTER JOIN orderstatus o ON f.buser_seq = o.buser_seq
			LEFT OUTER JOIN bom b ON o.bom_code = b.bom_code
			LEFT OUTER JOIN employee e ON o.emp_id = e.emp_id
			LEFT OUTER JOIN li_book i ON u.book_code = i.book_code
			LEFT OUTER JOIN book k ON i.book_isbn = k.book_isbn)
		WHERE 
			rnum <![CDATA[ >= ]]> #{start} AND rnum <![CDATA[ <= ]]> #{end}
	</select>
	
	<!-- 도서발주 페이지 paging -->
	<select id="totalre" resultType="int" parameterType="requestDTO">
		SELECT 
			count(*) cnt 
		FROM 
			library 
	</select>

</mapper>